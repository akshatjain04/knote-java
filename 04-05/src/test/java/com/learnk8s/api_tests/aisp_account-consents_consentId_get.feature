# ********RoostGPT********

# Test generated by RoostGPT for test MiniProjects using AI Type Open AI and AI Model gpt-4-1106-preview
# 
# Feature file generated for /aisp/account-consents/{consentId}_get for http method type GET 
# RoostTestHash=6c81494c1a
# 
# 

# ********RoostGPT********
Feature: Account Consent Setup API Endpoints

  Background:
    * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:4010')
    * url urlBase

  Scenario Outline: Retrieve account consent with valid consentId
    Given path 'aisp/account-consents/', <consentId>
    And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
    And header x-fapi-auth-date = <x_fapi_auth_date>
    And header x-fapi-customer-ip-address = <x_fapi_customer_ip_address>
    And header x-fapi-interaction-id = <x_fapi_interaction_id>
    And header Accept-Language = <accept_language>
    When method GET
    Then status 200
    And match response contains
      """
      { 
        data: '#object', 
        links: '#object' 
      }
      """
    And match response.data contains
      """
      { 
        consentId: '#string', 
        creationDate: '#string', 
        status: '#string', 
        statusUpdateDate: '#string', 
        permissions: '#array' 
      }
      """

    Examples:
      | read('aisp_account-consents_consentId_get.csv') |

  Scenario Outline: Retrieve account consent with invalid consentId
    Given path 'aisp/account-consents/', <consentId>
    And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
    And header x-fapi-auth-date = <x_fapi_auth_date>
    And header x-fapi-customer-ip-address = <x_fapi_customer_ip_address>
    And header x-fapi-interaction-id = <x_fapi_interaction_id>
    And header Accept-Language = <accept_language>
    When method GET
    Then status 400
    And match response contains
      """
      { 
        errors: '#array' 
      }
      """

    Examples:
      | read('aisp_account-consents_consentId_get.csv') |

  Scenario: Retrieve account consent without Authorization header
    Given path 'aisp/account-consents/7404e99b-1a4d-4b08-b441-c327661527f0'
    And header x-fapi-auth-date = 'Sun, 10 Sep 2017 19:43:31 UTC'
    And header x-fapi-customer-ip-address = '169.254.169.254'
    And header x-fapi-interaction-id = 'unique-id-12345'
    And header Accept-Language = 'en-HK'
    When method GET
    Then status 401

  Scenario: Retrieve account consent with unsupported Accept-Language
    Given path 'aisp/account-consents/7404e99b-1a4d-4b08-b441-c327661527f0'
    And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
    And header x-fapi-auth-date = 'Sun, 10 Sep 2017 19:43:31 UTC'
    And header x-fapi-customer-ip-address = '169.254.169.254'
    And header x-fapi-interaction-id = 'unique-id-12345'
    And header Accept-Language = 'fr-FR'
    When method GET
    Then status 406

  Scenario: Retrieve account consent with unsupported HTTP method
    Given path 'aisp/account-consents/7404e99b-1a4d-4b08-b441-c327661527f0'
    And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
    And header x-fapi-auth-date = 'Sun, 10 Sep 2017 19:43:31 UTC'
    And header x-fapi-customer-ip-address = '169.254.169.254'
    And header x-fapi-interaction-id = 'unique-id-12345'
    And header Accept-Language = 'en-HK'
    When method POST
    Then status 405
