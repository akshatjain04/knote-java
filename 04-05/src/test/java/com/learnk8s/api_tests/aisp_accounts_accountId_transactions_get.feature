# ********RoostGPT********

# Test generated by RoostGPT for test MiniProjects using AI Type Open AI and AI Model gpt-4-1106-preview
# 
# Feature file generated for /aisp/accounts/{accountId}/transactions_get for http method type GET 
# RoostTestHash=e9deccf97f
# 
# 

# ********RoostGPT********
Feature: Transactions by Account

  Background:
    * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:4010')
    * url urlBase
    * def authToken = karate.properties['AUTH_TOKEN']

  Scenario Outline: Get transactions for an account with valid parameters
    Given path 'aisp/accounts/', <accountId>, '/transactions'
    And header Authorization = 'Bearer ' + authToken
    And header x-fapi-auth-date = <x-fapi-auth-date>
    And header x-fapi-customer-ip-address = <x-fapi-customer-ip-address>
    And header x-fapi-interaction-id = <x-fapi-interaction-id>
    And header Accept-Language = <Accept-Language>
    And param fromDate = <fromDate>
    And param toDate = <toDate>
    When method get
    Then status 200
    And match response.data.transaction[*].accountId == <accountId>
    And match each response.data.transaction[*].accountNumber != null
    And match each response.data.transaction[*].transactionDate matches /\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z/
    And match each response.data.transaction[*].amount matches /^\d{1,13}$|^\d{1,13}\.\d{1,5}$/
    And match each response.data.transaction[*].currency matches /^[A-Z]{3,3}$/
    And assert response.data.links.self != null

    Examples:
      | read('aisp_accounts_accountId_transactions_get.csv') |

  Scenario: Get transactions for an account with invalid accountId
    Given path 'aisp/accounts/', 'invalidAccountId', '/transactions'
    And header Authorization = 'Bearer ' + authToken
    When method get
    Then status 400
    And match response.errors[*].code contains 'OB.Field.Invalid'

  Scenario: Get transactions for an account without authorization
    Given path 'aisp/accounts/', 'ThR-RpLMV5lZzDu8vrfEFg', '/transactions'
    When method get
    Then status 401

  Scenario: Get transactions for an account with unsupported Accept-Language
    Given path 'aisp/accounts/', 'ThR-RpLMV5lZzDu8vrfEFg', '/transactions'
    And header Authorization = 'Bearer ' + authToken
    And header Accept-Language = 'unsupported-language'
    When method get
    Then status 406

  Scenario: Get transactions for an account with too many requests
    Given path 'aisp/accounts/', 'ThR-RpLMV5lZzDu8vrfEFg', '/transactions'
    And header Authorization = 'Bearer ' + authToken
    When method get
    Then status 429
    And match response.message == 'Too Many Requests'
    And header Retry-After != null
